<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>mnmlst. | Store</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400..900&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg-gradient: linear-gradient(135deg, #181921 0%, #24263a 100%);
      --header-gradient: linear-gradient(90deg, #a28cff 0%, #fae07c 100%);
      --accent-yellow: #f6be3c;
      --accent-purple: #7b68ee;
      --text-light: #f0f0f0;
      --text-muted: #aaaac5;
    }
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: var(--bg-gradient);
      color: var(--text-light);
      overflow-x: hidden;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 40px;
    }
    .logo {
      font-size: 2rem;
      font-weight: 800;
      background: var(--header-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .cart-summary {
      font-size: 1.1rem;
      color: var(--accent-yellow);
      font-weight: 600;
    }
    .store-container {
      padding: 40px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 40px;
      max-width: 1200px;
      margin: auto;
    }
    .product {
      background: #1f2030;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      transition: transform 0.3s;
    }
    .product:hover {
      transform: scale(1.03);
    }
    .product img {
      width: 100%;
      height: 220px;
      object-fit: cover;
      border-radius: 10px;
      background: #333;
    }
    .product h3 {
      margin: 12px 0 6px;
      font-size: 1.2rem;
      color: var(--accent-yellow);
    }
    .product p {
      margin: 4px 0;
      font-size: 1rem;
      color: var(--text-muted);
    }
    .qty-controls {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 10px;
    }
    .qty-controls button {
      background: var(--accent-purple);
      border: none;
      color: white;
      font-weight: bold;
      font-size: 1.2rem;
      padding: 4px 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .qty-controls button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .qty-controls button:hover:not(:disabled) {
      background: var(--accent-yellow);
      color: #23243a;
    }
    .pagination {
      display: flex;
      justify-content: center;
      margin: 30px 0;
      gap: 10px;
    }
    .pagination button {
      padding: 8px 14px;
      border: none;
      border-radius: 6px;
      background: #2d2f45;
      color: var(--text-light);
      cursor: pointer;
    }
    .pagination button.active {
      background: var(--accent-yellow);
      color: #181921;
    }
    .checkout-bar {
      position: fixed;
      bottom: 0;
      width: 100%;
      background: #1c1d29;
      padding: 20px 40px;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 -4px 16px rgba(0,0,0,0.5);
      gap: 20px;
    }
    .checkout-bar button {
      background: var(--accent-yellow);
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      font-size: 1rem;
      cursor: pointer;
    }
    @media (max-width: 768px) {
      .store-container {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">mnmlst.</div>
    <div class="cart-summary">ðŸ›’ <span id="cart-count">0</span> items | â‚¹<span id="cart-total">0</span></div>
  </header>

  <main class="store-container" id="product-list"></main>
  <div class="pagination" id="pagination"></div>
  <div class="checkout-bar">
    <button onclick="checkout()">Proceed to Checkout</button>
  </div>

  <script>
    // ---- Data ----
    const products = [
      { id: 1, name: "Amber Drift", price: 1399, image: "perfume1.jpg" },
      { id: 2, name: "Coastal Rain", price: 1299, image: "perfume2.jpg" },
      { id: 3, name: "Velvet Rose", price: 1499, image: "perfume3.jpg" },
      { id: 4, name: "Noir Citrus", price: 1199, image: "perfume4.jpg" },
      { id: 5, name: "Woodland Echo", price: 999, image: "perfume5.webp" },
      { id: 6, name: "Jasmine Sky", price: 1290, image: "perfume6.avif" },
      { id: 7, name: "Citrus Ember", price: 1195, image: "perfume7.jpg" },
      { id: 8, name: "Vanilla Drift", price: 1350, image: "velvetrose.jpg" },
      { id: 9, name: "Herbal Mist", price: 1090, image: "perfume8.webp" },
      { id: 10, name: "Fresh Noir", price: 990, image: "perfume9.webp" },
    ];

    // ---- State ----
    let currentPage = 1;
    const itemsPerPage = 9;
    const inr = new Intl.NumberFormat('en-IN');

    // Load cart safely with default quantity = 0
    let cart = {};
    try {
      const saved = localStorage.getItem("cart");
      cart = saved ? JSON.parse(saved) : {};
      if (typeof cart !== 'object' || Array.isArray(cart)) cart = {};
    } catch {
      cart = {};
      localStorage.removeItem("cart");
    }

    // ---- Rendering ----
    function renderProducts(page) {
      const list = document.getElementById("product-list");
      list.innerHTML = "";
      const start = (page - 1) * itemsPerPage;
      const end = start + itemsPerPage;

      products.slice(start, end).forEach((p) => {
        const quantity = cart[p.id] || 0;
        const totalPrice = quantity > 0 ? p.price * quantity : p.price;

        const div = document.createElement("div");
        div.className = "product";
        div.innerHTML = `
          <img src="${p.image}" alt="${p.name}" />
          <h3>${p.name}</h3>
          <p id="price-${p.id}">
            â‚¹${inr.format(totalPrice)}
            <small style="color:gray;">(${inr.format(p.price)} each)</small>
          </p>
          <div class="qty-controls">
            <button id="minus-${p.id}" onclick="updateQuantity(${p.id}, -1)" ${quantity === 0 ? "disabled" : ""}>-</button>
            <span id="qty-${p.id}">${quantity}</span>
            <button id="plus-${p.id}" onclick="updateQuantity(${p.id}, 1)">+</button>
          </div>
        `;
        list.appendChild(div);
      });

      renderPagination();
    }

    function renderPagination() {
      const totalPages = Math.ceil(products.length / itemsPerPage);
      const container = document.getElementById("pagination");
      container.innerHTML = "";
      for (let i = 1; i <= totalPages; i++) {
        const btn = document.createElement("button");
        btn.textContent = i;
        if (i === currentPage) btn.classList.add("active");
        btn.onclick = () => {
          currentPage = i;
          renderProducts(currentPage);
        };
        container.appendChild(btn);
      }
    }

    // ---- Updates ----
    function updateQuantity(id, change) {
      const current = cart[id] || 0;
      const next = Math.max(0, current + change);
      if (next === 0) {
        delete cart[id];
      } else {
        cart[id] = next;
      }

      // Persist & refresh summary + row UI
      localStorage.setItem("cart", JSON.stringify(cart));
      updateCartSummary();
      updateProductRow(id);
    }

    function updateProductRow(id) {
      // If the product isn't on the current page (due to pagination), skip
      const qtyEl = document.getElementById(`qty-${id}`);
      const priceEl = document.getElementById(`price-${id}`);
      const minusBtn = document.getElementById(`minus-${id}`);
      if (!qtyEl || !priceEl || !minusBtn) return;

      const product = products.find(p => p.id === id);
      const quantity = cart[id] || 0;

      qtyEl.textContent = quantity;
      const totalPrice = quantity > 0 ? product.price * quantity : product.price;
      priceEl.innerHTML = `â‚¹${inr.format(totalPrice)} <small style="color:gray;">(${inr.format(product.price)} each)</small>`;
      minusBtn.disabled = quantity === 0;
    }

    function updateCartSummary() {
      const count = Object.values(cart).reduce((sum, qty) => sum + qty, 0);
      const total = Object.entries(cart).reduce((sum, [id, qty]) => {
        const product = products.find(p => p.id == id);
        return sum + (product.price * qty);
      }, 0);
      document.getElementById("cart-count").textContent = inr.format(count);
      document.getElementById("cart-total").textContent = inr.format(total);
    }

    // ---- Actions ----
    function checkout() {
      if (Object.keys(cart).length === 0) {
        alert("Cart is empty!");
        return;
      }
      // In a real site you'd go to a checkout page; here we persist and navigate.
      window.location.href = "checkout.html";
    }

    // ---- Init ----
    renderProducts(currentPage);
    updateCartSummary();
  </script>
</body>
</html>
